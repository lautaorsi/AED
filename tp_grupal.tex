\documentclass[10pt,a4paper]{article}

\input{AEDmacros}
\usepackage{caratula} % Version modificada para usar las macros de algo1 de ~> https://github.com/bcardiff/dc-tex


\titulo{Trabajo Practico}

\fecha{\today}

\materia{Algoritmos y Estructuras de Datos}
\grupo{Grupo AlgoTango}

\integrante{Orsi, Lautaro Manuel}{689/23}{Lautaorsi@gmail.com}
\integrante{Zerbetto De Palma, Gerardo Gabriel}{900/22}{g.zerbetto@gmail.com}
\integrante{Simoza Sanchez, Valeria Andreina}{1027/22}{vsimoza.vs@gmail.com}
\integrante{Apellido, Nombre4}{004/01}{email4@dominio.com}
% Pongan cuantos integrantes quieran

% Declaramos donde van a estar las figuras
% No es obligatorio, pero suele ser comodo
\graphicspath{{../static/}}

\begin{document}

\maketitle

\section{Especificaci\'on}
\subsection{Redistribucion De Los Frutos}

\begin{proc}{redistribucionDeLosFrutos}{\In recursos : \TLista{\ent}, \In cooperan: \TLista{\bool}}{\TLista{\ent}}
	\requiere{|recursos| = |cooperan| \land recursosValidos(recursos)}
	\asegura{|res| = |recursos| \yLuego (\forall i : \ent)(0\le i  < \longitud{recursos} \implicaLuego \Biggl(\biggl((cooperan[i] = true) \implicaLuego res[i] = \\\dfrac{fondoMonetario(recursos,cooperan)}{|recursos|}\biggr) \land \biggl((cooperan[i] = false) \implicaLuego res[i] = recursos[i] + \\\dfrac{fondoMonetario(recursos,cooperan)}{|recursos|})\biggr)\Biggr)}
    \aux{fondoMonetario}{recursos:\TLista{\float},cooperan:\TLista{\bool}}{\float}{\sum\limits_{j=0}^{|recursos|-1}\Bigl(\IfThenElse{\bigl(cooperan[j]=true\bigr)}{\bigl(recursos[j]\bigr)}{\\ \bigl(0\bigr)}\Bigr)}
    \pred{recursosValidos}{recursos:\TLista{\float}}{(\forall i : \ent)(0 \leq i < |recursos| \implicaLuego recursos[i] > 0)}
	\textbf{Desarrollo 1.1}
	\\
	Para este ejercicio implementamos un aux \textit{fondoMonetario} que calcula |en base a las listas \textit{cooperan} y \textit{recursos}| una sumatoria de la totalidad de recursos que seran redistribuidos al finalizar el paso temporal, sumando al fondo los recursos de aquellos que cooperen y sin sumar los que no.
\\ Empleamos este aux para luego calcular el recurso de cada individuo, si este decidia cooperar su recurso sera la division equitativa y si no cooperaba su recurso sera la plata obtenida mas la division equitativa.
\end{proc}







\subsection{Trayectoria De Los Frutos Individuales a Largo Plazo}

\begin{proc}{trayectoriaDeLosFrutosIndividualesALargoPlazo}{\Inout trayectorias: \TLista{\TLista{\float}}, \In cooperan: \TLista{\bool}, \In apuestas:
\TLista{\TLista{\float}}, \In pagos: \TLista{\TLista{\float}}, \In eventos: \TLista{\TLista{\nat}}}{}
	\requiere{trayectoriasValidas(old(trayectorias)) \\ \land mismaLongitud(old(trayectorias),pagos,apuestas,eventos,cooperan) \\ \land  pagosPositivos(pagos) \\ \land apuestasValidas(apuestas) \\ \land longitugApuestasPagos(apuestas,pagos) \\ \land longitudSublistas(pagos) \\ \land longitudSublistas(apuestas) \\ \land longitudSublistas(eventos)}
	\asegura{(\forall i : \ent)(0 \leq i < |old(trayectorias)| \implicaLuego (trayectorias[i][0] = (old(trayectorias)[i])[0])\yLuego (\forall j : \ent)(0 \leq j < |eventos[i]| \implicaLuego trayectorias[i][j+1]=calculoDeRecursosSegunCooperacion(trayectorias,pagos,apuestas,eventos,\\cooperan,i,j)))}
	\aux{calculoDeRecursosSegunCooperacion}{trayectorias,pagos,apuestas:\TLista{\TLista{\float}},eventos:\TLista{\TLista{\nat}},cooperan:\\\TLista{\bool},individuo:\ent,ronda:\ent}{\float}{\IfThenElse{cooperan[individuo] = true}{fondoMonetarioRepartido(trayectorias,pagos,\\apuestas,eventos,cooperan,ronda)}{calculoRecursos(trayectorias[individuo][ronda],\\pagos[individuo][eventos[individuo][ronda]],apuestas[individuo[eventos[individuo][ronda]]])+fondoMonetarioRepartido\\(trayectorias,pagos,apuestas,eventos,cooperan,ronda)}}
    \aux{calculoRecursos}{recurso,pago,apuesta:\float}{\float}{recurso*pago*apuesta}
    \aux{fondoMonetario}{trayectorias,pagos,apuestas:\TLista{\TLista{\float},eventos:\TLista{\TLista{\nat},cooperan:\TLista{\bool},ronda:\ent}}}{\float}{\sum\limits_{h=0}^{|cooperan|-1} \IfThenElse{cooperan[h] = true}{calculoRecursos(trayectorias[h][ronda],pagos[h][eventos[h][ronda]],\\apuestas[h][eventos[h][ronda]])}{0}}
    \aux{fondoMonetarioRepartido}{trayectorias,pagos,apuestas:\TLista{\TLista{\float}},eventos:\TLista{\TLista{\nat}},cooperan:\TLista{\bool},ronda:\ent}{\float}{\dfrac{fondoMonetario(trayectorias,pagos,\\apuestas,eventos,cooperan,ronda)}{|cooperan|}}
    \aux{sumaApuestas}{apuestas:\TLista{\TLista{\float}}, individuo: \ent}{\float}{\sum\limits_{h=0}^{|apuestas[individuo]|-1} apuestas[individuo][h]}
    \pred{mismaLongitud}{trayectorias,pagos,apuestas:\TLista{\TLista{\float}},eventos:\TLista{\TLista{\nat}},cooperan:\TLista{\bool}}{|trayectorias|=|cooperan|=|apuestas|=|pagos|=|eventos|}
    \pred{trayectoriasValidas}{trayectorias:\TLista{\TLista{\float}}}{|trayectorias| > 0 \land (\forall i: \ent)(0 \leq i < |trayectorias| \implicaLuego |trayectorias[i]| = 1 \yLuego (\forall x:\float)(x \in trayectorias[i] \implicaLuego x > 0))}
    \pred{pagosPositivos}{pagos:\TLista{\TLista{\float}}}{(\forall i,j:\ent)(0 \leq i < |pagos| \yLuego (0 \leq j < |pagos[i]| \implicaLuego pagos[i][j] > 0))}
    \pred{apuestasValidas}{apuestas:\TLista{\TLista{\float}}}{(\forall i,j:\ent)(0 \leq i < |apuestas| \implicaLuego sumaApuestas(apuestas,i) = 1 \yLuego (0 \leq j < |apuestas[i]| \implicaLuego 0 \leq apuestas[i][j] \leq 1))}
    \pred{longitudApuestasPagos}{apuestas,pagos:\TLista{\TLista{\float}}}{(\forall i:\ent)(0 \leq i < |apuestas| \implicaLuego |apuestas[i]| = |pagos[i]|)}
    \pred{longitudSublistas}{lista:\TLista{\TLista{T}}}{(\forall i:\ent)(0 \leq i < |lista| \implicaLuego (|lista[0]| > 0 \yLuego |lista[0]| = |lista[i]|))}

\end{proc}



\subsection{Trayectoria Extraña Escalera}

\begin{proc}{trayectoriaExtrañaEscalera}{\In trayectoria: \TLista{\float}}{\bool}
	\requiere{|trayectoria| > 0}
	\asegura{res = true \iff ((|trayectoria| = 1) \lor (|trayectoria| = 2 \land \neg(todosIguales(trayectoria)) \lor (|trayectoria| > 2 \land hayUnicoMax(trayectoria)))}
	\pred{hayUnicoMax}{Trayectoria: \TLista{\float}}{
	CantidadMaximos(Trayectoria) = 1}
    \pred{todosIguales}{lista:\TLista{\float}}{(\forall i,j : \ent)(0 \leq i < |lista| \land 0 \leq j < |lista| \land i \neq j \implicaLuego lista[i] = lista[j])}
	\aux{CantidadMaximos}{lista: \TLista{\float}}{\ent}{\sum\limits_{i =1}^{|lista|-2}\IfThenElse{\Bigl(lista[i-1] < lista[i]\Bigr) \land \Bigl(lista[i] > lista[i+1]\Bigr)}{(1)}{(0)}}


\textbf{Desarrollo 1.3:}
\\
En este ejercicio, utilizamos una separacion en 3 distintos casos, 2 de ellos unicos y uno generalizado, es importante notar que la trayectoria que se recibe es una lista que representa los recursos a medida que avanzan las rondas (o pasos temporales).
\\ El primero, siendo que $|\textit{trayectoria}|$ es 1 (se juega una ronda) sabemos que sera maximo local pues no tiene vecinos
\\ El segundo, siendo que $|\textit{trayectoria}|$ es 2 y que, si son distintos, trivialmente alguno es mayor que el otro siendo entonces el maximo local
\\El ultimo y mas general, dada una secuencia de mas de 2 elementos se busca si efectivamente hay algun numero mayor que sus numeros vecinos y que ademas sea el \textbf{unico} con esa propiedad en la secuencia
\\ (Podriamos ahorrarnos el pred hayUnicoMax pero creemos que queda mas legible de esta forma)
\end{proc}

\subsection{Individuo Decide Si Cooperar O No}

\begin{proc}{individuoDecideSiCooperarONo}{\In individuo: \nat, \In recursos: \TLista{\float}, \Inout cooperan: \TLista{\bool}, \In apuestas: \TLista{\TLista{\float}}, \In pagos: \TLista{\float}, \In eventos: \TLista{\TLista{\nat}}}{}
	\requiere{mismaLongitud(recursos,pagos,apuestas,eventos,cooperan) \\ \land individuo < |eventos| \\ \land pagosPositivos(pagos) \\ \land apuestasValidas(apuestas) \\ \land longitudApuestasPagos(apuestas,pagos) \\ \land longitudSublistas(apuestas) \\ \land longitudSublistas(eventos) \\ \land longitudSublistas(pagos) }
	\asegura{(\exists Trayectorias,TrayectoriasNegadas : {\TLista{\TLista{\ent}}}) (\exists CooperanNegada {\TLista{\bool}}) 
\\ \biggl( \Bigl(Trayectorias = ValidarTrayectoria(Trayectorias, cooperan, apuestas, pagos, eventos, recursos)\Bigr)
 \\ \land \Bigl( \neg(cooperan[individuo]) = cooperanNegada[Individuo] \Bigr) 
\\ \land (\forall i : \ent) \Bigl( 0 \leq i < |cooperan| \land i \neq Individuo \land cooperan[i] = cooperanNegada[i]  \Bigr)
\\ \land \Bigl( TrayectoriasNegada = ValidarTrayectorias(TrayectoriasNegada, cooperanNegada, apuestas, pagos, eventos, recursos)\Bigr)   \biggr) 
\\ \implicaLuego \biggl( \Bigl( \bigl(Trayectorias[Individuo][|eventos[0]|-1] \geq TrayectoriasNegada[Individuo][|eventos[0]| - 1]\bigr) 
\\ \land cooperan[Individuo] = old(cooperan[Individuo]) \Bigr) 
\\ \lor \Bigl(  \bigl(Trayectorias[Individuo][|eventos[0]|-1] < TrayectoriasNegada[Individuo][|eventos[0]| - 1]\bigr) 
\\ \land cooperan[Individuo] = cooperanNegada[Individuo]     \Bigr)
  \biggr)}

 \pred{ValidarTrayectoria}{trayectorias: \TLista{\TLista{\ent}},cooperan: \TLista{\bool}, apuestas: \TLista{\TLista{\float}}, pagos: \TLista{\float},eventos: \TLista{\TLista{\nat}}, recursos: \TLista{\float}}{(\forall i : \ent)(0 \leq i < |recursos| \implicaLuego (trayectorias[i][0] = recursos[i])\yLuego \\ (\forall j : \ent)(0 \leq j < |eventos[i]| \implicaLuego
 \\ trayectorias[i][j+1]=calculoDeRecursosSegunCooperacion(trayectorias,pagos,apuestas,eventos,cooperan,i,j)))}

    *preds pagosPositivos, apuestasValidas, longitudApuestasPagos, longitudSublistas y calculoDeRecursosSegunCooperacion (con sus dependencias) declarados en ejercicio 1.2
\\
\textbf{Desarrollo 1.4:}
\\
 La dificultad de este ejercicio aparece en no tener la secuencia de trayectorias individuales, viendo que calcularlas llevaria mucha complejidad planteamos un cuantificador y predicamos sobre el, analizando las posibles secuencias \textit{trayectorias y trayectoriasNegada} (siendo esta ultima la que corresponderia al caso de la negacion del booleano de cooperacion del individuo) podemos, utilizando los predicados y auxiliares del ejercicio 1.2 y la lista de recursos verificar que efectivamente estas listas son las que deberiamos obtener si calcularamos las trayectorias al largo plazo. \\ \\
Para validar esta trayectoria comparamos que las primeras posiciones de la trayectoria correspondan a los recursos (basicamente, que el punto de partida de la trayectoria sea correcta) y luego, verificamos que cada posicion \textit{N} de la lista, sea correspondiente a calcular los recursos \textit{N} rondas para cada individuo, partiendo de la base de la ronda 0 (recursos). Es importante notar, que para el caso \textit{trayectoriasNegada} utilizaremos la lista \textit{cooperanNegada}, pues el calculo dependera de si el individuo coopera o no.
\\ \\
Al final, podemos observar que utilizando la comparacion de la ultima posicion de \textit{trayectoria} del individuo (basandonos en la cantidad de eventos) con la ultima posicion de la \textit{trayectoriaNegada} asignamos, segun corresponda el valor original (en el primer caso) y el valor negado en el segundo.-


\end{proc}

\subsection{Individuo Actualiza Apuesta}

\begin{proc}{individuoActualizaApuesta}{\In individuo: \nat, \In recursos: \TLista{\float}, \In cooperan: \TLista{\bool}, \Inout apuestas: \TLista{\TLista{\float}}, \In pagos: \TLista{\TLista{\float}}, \In eventos: \TLista{\TLista{\nat}}}{}
	\requiere{expresionBooleana1}
	\asegura{(\forall s: \TLista{\float}) esMaximaGanancia(s,recursos[individuo],pagos[individuo],eventos[individuo]) \implicaLuego 
	\\ apuestas[individuo] = s}
	\pred{esMaximaGanancia}{apuesta: \TLista{\float}, recurso: \float, pago: \TLista{\float}, evento: \TLista{\nat}}{\textbf{if}\Bigl((\exists q: \TLista{\float})\\(RecursoIndividualFinal(q,pago,evento,recurso) > RecursoIndividualFinal(apuesta, pago, evento, recurso))\Bigr)
 \\ \textbf{Then}(False)
\\ \textbf{Else}(True)} 
	
\aux{RecursoIndividualFinal}{\In apuesta: \TLista{\float}, \In pago: \TLista{\float}, \In evento: \TLista{\nat}, \In recurso: \float}{\float}{ \\ \Bigl(recurso.\prod_{i=0}^{|evento|-1}\bigl(pago[evento[i]].apuesta[evento[i]]\bigr)\Bigr)}


\end{proc}







\section{Demostracion de correctitud}

\begin{proc}{nombre}{\In paramIn : \nat, \Inout paramInout : \TLista{\ent}}{tipoRes}
	%    \modifica{parametro1, parametro2,..}
	\requiere{expresionBooleana1}
	\asegura{expresionBooleana2}
	\aux{auxiliar1}{parametros}{tipoRes}{expresion}
	\pred{pred1}{parametros}{expresion} 
\end{proc}

\aux{auxiliarSuelto}{parametros}{tipoRes}{expresion}
% \paraTodo{variable}{tipo}{expresion}
% \existe{variable}{tipo}{expresion}
% Pueden tener [unalinea] para que no se divida en varias lineas
\pred{predSuelto}{parametros}{\paraTodo[unalinea]{variable}{tipo}{algo \implicaLuego expresion}}
\pred{predSuelto}{parametros}{\existe[unalinea]{variable}{tipo}{algo \yLuego expresion}}



\end{document}
